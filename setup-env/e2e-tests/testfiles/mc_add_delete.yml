##
##
description: adds and deletes from mc

tests:

- name: verify no users to start
  actions: [mcapi-showusers]
  curuserfile: "{{datadir}}/mc_admin.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mcappdata_empty.yml"
    filetype: mcusers

- name: verify no provisioned data to start
  actions: [mcapi-show]
  curuserfile: "{{datadir}}/mc_admin.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mcappdata_empty.yml"
    filetype: mcdata

- name: create users
  actions: [mcapi-createusers]
  apifile: "{{datadir}}/mc_user1.yml,{{datadir}}/mc_user2.yml"

- name: admin creates controllers, flavors; verify it is there
  actions: [mcapi-create,mcapi-show]
  curuserfile: "{{datadir}}/mc_admin.yml"
  apifile: "{{datadir}}/mc_admin_data.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mc_admin_data.yml"
    filetype: mcdata

- name: user1 creates operator/cloudlets; verify it is there
  actions: [mcapi-create,mcapi-show]
  curuserfile: "{{datadir}}/mc_user1.yml"
  apifile: "{{datadir}}/mc_user1_data.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mc_user1_data.yml"
    filetype: mcdata

- name: user2 creates apps; verify it is there
  actions: [mcapi-create,mcapi-show]
  curuserfile: "{{datadir}}/mc_user2.yml"
  apifile: "{{datadir}}/mc_user2_data.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mc_user2_data.yml"
    filetype: mcdata

- name: user2 deletes apps; verify it is empty
  actions: [mcapi-delete,mcapi-show]
  curuserfile: "{{datadir}}/mc_user2.yml"
  apifile: "{{datadir}}/mc_user2_data.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mcappdata_empty.yml"
    filetype: mcdata

- name: user1 deletes operator/cloudlets; verify it is empty
  actions: [mcapi-delete,mcapi-show]
  curuserfile: "{{datadir}}/mc_user1.yml"
  apifile: "{{datadir}}/mc_user1_data.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mcappdata_empty.yml"
    filetype: mcdata

- name: admin delete controllers, flavors, verify it is empty
  actions: [mcapi-delete,mcapi-show]
  curuserfile: "{{datadir}}/mc_admin.yml"
  apifile: "{{datadir}}/mc_admin_data.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mcappdata_empty.yml"
    filetype: mcdata

- name: delete users, verify no users left
  actions: [mcapi-deleteusers,mcapi-showusers]
  curuserfile: "{{datadir}}/mc_admin.yml"
  apifile: "{{datadir}}/mc_user1.yml,{{datadir}}/mc_user2.yml"
  compareyaml:
    yaml1: "{{outputdir}}/show-commands.yml"
    yaml2: "{{datadir}}/mcappdata_empty.yml"
    filetype: mcusers
